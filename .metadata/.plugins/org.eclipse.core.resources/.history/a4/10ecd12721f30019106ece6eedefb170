package application;

import applicationExtension.SingleAdaptorOutput;
import javafx.collections.ObservableList;

public class ServiceOfAdaptorMessenger {
	private IMessaging sending;
	
	public void sendLongText(String longMessage){
		sending = new AdaptorInputLongText();
		sending.sendTheMessage(doTheBreaking(longMessage));
	}
	
	private String doTheBreaking(String longMessage){
		if(longMessage.length() > 25){
			Integer counterEnd = 0;
			String finalMessage = "";
			while (counterEnd <= longMessage.length()){
				if(counterEnd + 25 > longMessage.length())
					finalMessage += longMessage.substring(counterEnd, longMessage.length());
				else{
					finalMessage += longMessage.substring(counterEnd, counterEnd + 25);
					finalMessage += "\n";
				}
				counterEnd = counterEnd + 25;
			}
			return finalMessage;
		} else {
			return longMessage;
		}
	}
	
	public void sendShortText(String shortMessage){
		sending = new AdaptorInputShortText();
		sending.sendTheMessage(shortMessage);
	}
	
	public void sendCalculateableText(String operationMessage){
		Integer result = 0;
		if(operationMessage.contains("+"))
			Integer indexHalf = operationMessage.indexOf("+")
			result = doTheOperation(operationMessage.split("+"), Operation.ADDING);
		if(operationMessage.contains("-"))
			result = doTheOperation(operationMessage.split("-"), Operation.SUBTARCTING);
		if(operationMessage.contains("x"))
			result = doTheOperation(operationMessage.split("x"), Operation.MULTIPLYING);
		if(operationMessage.contains("/"))
			result = doTheOperation(operationMessage.split("/"), Operation.DIVIDING);
		
		String finalMessage = result.toString();
		sending = new AdaptorInputCalculateingText();
		sending.sendTheMessage(finalMessage);
	}
	
	private Integer doTheOperation(String[] parts, Operation op ){
		try{
			if(op == Operation.ADDING)
				return Integer.parseInt(parts[0]) + Integer.parseInt(parts[1]);
			else if(op == Operation.SUBTARCTING)
				return Integer.parseInt(parts[0]) - Integer.parseInt(parts[1]);
			else if(op == Operation.MULTIPLYING)
				return (Integer) (Integer.parseInt(parts[0]) * Integer.parseInt(parts[1]));
			else {
				if(parts[1].equals("0"))
					return 0;
				return (Integer)(Integer.parseInt(parts[0]) / Integer.parseInt(parts[1]));
			}
		}catch (Exception e) {
			e.getStackTrace();
		}
		return 0;
	}
	
	private enum Operation {
		ADDING, SUBTARCTING, MULTIPLYING, DIVIDING
	}
	
	
	public ObservableList<String> getBackTheMessageResult(){
		return SingleAdaptorOutput.getTheMessages();
	}
}
